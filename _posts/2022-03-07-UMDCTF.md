---
layout: post
category: writeups
title: "UMDCTF 2022"
date: 2022-03-07
head_message: "These are our writeups for the challenges presented in this year's <a href=\"https://umdctf.io\">UMDCTF</a>."
head_ctf_categories:
  - crypto
  - forensics
  - hw/rf
  - misc
  - osint
  - pwn
  - rev
  - web
---

# Sources

Sources and other assets will be available shortly in the [official repo](https://github.com/UMD-CSEC/UMDCTF-Public-Challenges/tree/main/UMDCTF2022).

---

# Crypto

## MTP

> _One-time pad? More like multiple-time pad ;)_<br>
> _Attachments: encrypt.py, ciphertexts.txt_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## snowden

> _Eddy is sending encrypted messages out, but we can't quite figure out what he is saying._

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

---

# Forensics

## Blue

> _Larry gave me this python script and an image. What is she trying to tell me?_<br>
> _Attachments: bluer.png, steg.py_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## How to Breakdance

> _My friend ctf\_playah has been learning to breakdance, can you find his youtube password? Upon submission, wrap his password with UMDCTF{}._

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## jdata

> _no shade... but also..._<br>
> _Attachments: jdata.zip_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Magic Plagueis the Wise

> _Did you ever hear the tragedy of Darth Plagueis The Wise? It's written here in a magical way, but I can't figure out how to read it. Can you help me?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Renzik's Case

> _My friend deleted important documents off of my flash drive, can you help me find them?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Xorua

> _When Fred put his Zorua in the Driftveil City Pokecenter's PC something a bit strange happened. Can you help him figure out what happened?_<br>
> _Attachments: After.png, Before.png_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

---

# HW/RF

## Gee, queue are ex?

> _Oh the wonderful world of radio frequency.. what can you see?_<br>
> _Attachments: painter.iq_

This challenge was giving out some nice hints that a modern amateur radio operator could pick up quite easily:

+ The name of the challenge itself was wordplay on [GQRX](https://gqrx.dk/), a known [SDR](https://en.wikipedia.org/wiki/Software-defined_radio) interface, and probably the QRX acronym (see [Q Code](https://en.wikipedia.org/wiki/Q_code)) itself.
+ Judging by its extension, the attached file could have been raw [I/Q data](https://www.pe0sat.vgnet.nl/sdr/iq-data-explained/). _(Funnily enough, `file` was spitting out `painter.iq: OpenPGP Public Key`)_

Converting the raw data into audio and piping it through `sox` by fiddling with the arguments to get a readable spectrum would have been boring - _nonchalantly sweeps shell history file under the rug_ - and thus the occasion was perfect to pretend to know exactly what each GNURadio block does.

![GNURadio project](/assets/img/UMDCTF_2022/geequeueareex_gnuradio.jpg)

With some slight processing (skipping the initial junk present at the start of the stream, filtering the part of the spectrum that has interesting contents, playing with the sample rate due to the absence of hardware flow control) it became evident that the flag was being painted on the waterfall character by character.

![GNURadio GUI](/assets/img/UMDCTF_2022/geequeueareex_gnuradio.gif)

With that knowledge, a proper spectrogram could be generated:

```plaintext
sox -t raw -r 500000 -e float -b 32 painter.iq -n trim 189 1157 rate 100k spectrogram -X 6
```

![Spectrogram](/assets/img/UMDCTF_2022/geequeueareex_spectrogram.jpg)

After the CTF ended, the admins confirmed that the signal had been partially generated with [spectrum_painter](https://github.com/polygon/spectrum_painter) and, to introduce some realistic fading and noise, transmitted and re-recorded with an RTL-SDR and an HackRF. Clever!

üèÅ __UMDCTF{D15RUP7_R4D1OZ}__{:.spoiler}

## Bongo cat

> _do u even use dvorak u dweeb. i only hav 8 keys on my keyboard and i type at 12000 wPM. i bet u even look at ur hands when u type. i haven't looked at my hands ever._<br>
> _Attachments: bongo-cat.hex_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Minetest 1 - Digital Logic Primer

> _Join the server to checkout the minetest challenges. You do not need to solve one before the other!_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Minetest 2 - MUX

> _Join the server to checkout the minetest challenges. You do not need to solve one before the other!_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

---

# Misc

## Blockchain 1 - Hashcash

> _Gary has an email service, but he hates spammers, so he implemented Hashcash._

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Blockchain 2 - ChungusCoin

> _Chungus Coin is a PoW blockchain that holds indefinite value. There is a reward for those who mine!_<br>
> _NOTE: The PoW required for this blockchain is {p0}{p1} s.t._<br>
> `p0 = proof of previous block`<br>
> `p1 = proof of block being created`<br>
> `sha256(f'{p0}{p1}')\[:5] == '00000'`

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## ChungusBot v2

> _Check out my code!_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## RSI 1

> _A friend of mine left me a mysterious file from a game he was playing._<br>
> _Attachments: tutorial.osr_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## RSI 2

> _I got addicted to the game, and my friend left me another one of his cool replays._<br>
> _Attachments: big\_b.osr_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

---

# OsInt

## Justina 1

> _After Justin's adventure in Russia, his sister, Justina Zimmerman has scurried off somewhere and we need to find her. There must be a way to see what she has been up to. Justin might even be able to help us._

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Justina 2

> _Can you figure out which city Justina has been staying in? Hopefully we can find her soon!_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Justina 3

> _I think Justina is going to another place! I can't keep up with her. Help me find her._

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Justina 4

> _I've been chatting with Justina as she travels, and she is settling down with her french boyfriend. They are even having a kid! I want to send her a baby shower gift but I don't know what to get her... She told me there is some online registry for gifts but it's under her boyfriends name. Can you find the registry online?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## ketchup

> _I took a picture with this guy a few years ago but I forgot his name! Can you tell me who he is?_<br>
> _Attachments: ketchup.png_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Outdoors 1

> _My friend Jason Heyson recently got into live-streaming. He's been streaming a place in his hometown, but he won't give me the link! It must be related to the environment, the outdoors, or real life given my current context. Can you find his stream for me?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Outdoors 2

> _Thank you for finding the livestream. It looks like Jason must have moved because I do not recognize the the place he is streaming at all! Can you give me the address of the orangeish building on the live stream?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Unaccounted For Co-Worker

> _Help! My co-worker hasn't showed up to work for the past week and my boss wants me to find out where he went. I know that he took an American Airlines flight from the "Mile High City" to the city with the largest historic theatre district on February 24th. A couple days later, I heard he took a train northwest 8 stops from Union Station. Can you tell me the aircraft type and the final destination city?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

---

# Pwn

## Classic Act

> _Pwning your friends is a class act. So why not do it to some random server?_<br>
> _Attachments: classicact_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Legacy

> _Fred just won‚Äôt keep up with the times. Why don't you show him the error of his ways?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## The Show Must Go On

> _We are in the business of entertainment, the show must go on! Hope we can find someone to replace our old act super fast..._<br>
> _Attachments: theshow_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

---

# Rev

## DragonPit

> _Fred is trying to learn how to deal with dragons. Can you help him out?_<br>
> _Attachments: dragonPit_

For this challenge we were given an ELF file, with
```
file dragonpit
``` 
command we could see that the file was not stripped.

Running the file we are asked to enter a secret phrase, since the file is not stripped we can use objdump
```
objdump -d dragonpit
```
to parse it, and we can notice the function cmp right away, with this we know that the program will compare two strings, the one entered by us and the secret one. 
Analyzing the file with gdb we find our secret string "wh3nTheDr4gsHPis1048", with which we get the flag.

üèÅ __UMDCTF{UMDCTF{BluSt0l3dr4g}}__{:.spoiler}

## tiny

> _Scan for free crypto currency!_<br>
> _Attachments: tiny.png_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

---

# Web

## A Simple Calculator

> _Calc you later! :)_<br>
> _Attachments: A\_Simple\_Calculator.zip_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Customer Support

> _Contact Devils customer supoprt and see what they have to offer._<br>
> _Attachments: Customer\_Support.zip_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

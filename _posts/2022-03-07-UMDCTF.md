---
layout: post
category: writeups
title: "UMDCTF 2022"
date: 2022-03-07
head_message: "These are our writeups for the challenges presented in this year's <a href=\"https://umdctf.io\">UMDCTF</a>."
head_ctf_categories:
  - crypto
  - forensics
  - hw/rf
  - misc
  - osint
  - pwn
  - rev
  - web
---

# Sources

Sources and other assets will be available shortly in the [official repo](https://github.com/UMD-CSEC/UMDCTF-Public-Challenges/tree/main/UMDCTF2022).

---

# Crypto

## MTP

> _One-time pad? More like multiple-time pad ;)_<br>
> _Attachments: encrypt.py, ciphertexts.txt_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## snowden

> _Eddy is sending encrypted messages out, but we can't quite figure out what he is saying._

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

---

# Forensics

## Blue

> _Larry gave me this python script and an image. What is she trying to tell me?_<br>
> _Attachments: bluer.png, steg.py_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## How to Breakdance

> _My friend ctf\_playah has been learning to breakdance, can you find his youtube password? Upon submission, wrap his password with UMDCTF{}._

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## jdata

> _no shade... but also..._<br>
> _Attachments: jdata.zip_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Magic Plagueis the Wise

> _Did you ever hear the tragedy of Darth Plagueis The Wise? It's written here in a magical way, but I can't figure out how to read it. Can you help me?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Renzik's Case

> _My friend deleted important documents off of my flash drive, can you help me find them?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Xorua

> _When Fred put his Zorua in the Driftveil City Pokecenter's PC something a bit strange happened. Can you help him figure out what happened?_<br>
> _Attachments: After.png, Before.png_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

---

# HW/RF

## Gee, queue are ex?

> _Oh the wonderful world of radio frequency.. what can you see?_<br>
> _Attachments: painter.iq_

This challenge was giving out some nice hints that a modern amateur radio operator could pick up quite easily:

+ The name of the challenge itself was wordplay on [GQRX](https://gqrx.dk/), a known [SDR](https://en.wikipedia.org/wiki/Software-defined_radio) interface, and probably the QRX acronym (see [Q Code](https://en.wikipedia.org/wiki/Q_code)) itself.
+ Judging by its extension, the attached file could have been raw [I/Q data](https://www.pe0sat.vgnet.nl/sdr/iq-data-explained/). _(Funnily enough, `file` was spitting out `painter.iq: OpenPGP Public Key`)_

Converting the raw data into audio and piping it through `sox` by fiddling with the arguments to get a readable spectrum would have been boring - _nonchalantly sweeps shell history file under the rug_ - and thus the occasion was perfect to pretend to know exactly what each GNURadio block does.

![GNURadio project](/assets/img/UMDCTF_2022/geequeueareex_gnuradio.jpg)

With some slight processing (skipping the initial junk present at the start of the stream, filtering the part of the spectrum that has interesting contents, playing with the sample rate due to the absence of hardware flow control) it became evident that the flag was being painted on the waterfall character by character.

![GNURadio GUI](/assets/img/UMDCTF_2022/geequeueareex_gnuradio.gif)

With that knowledge, a proper spectrogram could be generated:

```plaintext
sox -t raw -r 500000 -e float -b 32 painter.iq -n trim 189 1157 rate 100k spectrogram -X 6
```

![Spectrogram](/assets/img/UMDCTF_2022/geequeueareex_spectrogram.jpg)

After the CTF ended, the admins confirmed that the signal had been partially generated with [spectrum_painter](https://github.com/polygon/spectrum_painter) and, to introduce some realistic fading and noise, transmitted and re-recorded with an RTL-SDR and an HackRF. Clever!

üèÅ __UMDCTF{D15RUP7_R4D1OZ}__{:.spoiler}

## Bongo cat

> _do u even use dvorak u dweeb. i only hav 8 keys on my keyboard and i type at 12000 wPM. i bet u even look at ur hands when u type. i haven't looked at my hands ever._<br>
> _Attachments: bongo-cat.hex_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Minetest 1 - Digital Logic Primer

> _Join the server to checkout the minetest challenges. You do not need to solve one before the other!_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Minetest 2 - MUX

> _Join the server to checkout the minetest challenges. You do not need to solve one before the other!_

In this challenge we had to connect to the same minetest server of the [minetest 1](#minetest-1---digital-logic-primer) challenge, there were eight closed rooms where the circuit shown in the gif below was placed. We couldnt access the rooms, we only had access to the 4 inputs and the only output (the red dot in the gif).
The flag was composed of 24 bits and to get the complete flag we had to solve all the eight rooms, therefore three bits for room (s1, s2, s3).

![logic-gate-gif](/assets/img/UMDCTF_2022/minetest2-logic-gate.gif)

To find the bits s1, s2 and s3, we wrote a simple script that given a four bits input returns the possible sequence of (s1, s2, s3) that lits the lamp, the script had to be executed multiple times for room because every input could return more than one sequence of (s1, s2, s3).

```python
import sys

i = []
i = list(map(int, sys.stdin.readline().split(' ')))
lamp = 1
signals = [(0, 0, 0), (1, 0, 0), (0, 1, 0), (0, 0, 1), (1, 1, 0), (0, 1, 1), (1, 0, 1), (1, 1, 1)]
for signal in signals:
    muxA = i[2] if signal[0] == 0 else i[3]
    muxB = i[0] if signal[1] == 0 else i[1]
    muxC = muxB if signal[2] == 0 else muxA
    x = (muxA and not muxB) or (not muxA and muxB)
    a = x and muxC
    if a == lamp:
        print(f"FOUND : {s}")
```

üèÅ __UMDCTF{101111100000011011111000}__{:.spoiler}

---

# Misc

## Blockchain 1 - Hashcash

> _Gary has an email service, but he hates spammers, so he implemented Hashcash._

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Blockchain 2 - ChungusCoin

> _Chungus Coin is a PoW blockchain that holds indefinite value. There is a reward for those who mine!_<br>
> _NOTE: The PoW required for this blockchain is {p0}{p1} s.t._<br>
> `p0 = proof of previous block`<br>
> `p1 = proof of block being created`<br>
> `sha256(f'{p0}{p1}')\[:5] == '00000'`

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## ChungusBot v2

> _Check out my code!_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## RSI 1

> _A friend of mine left me a mysterious file from a game he was playing._<br>
> _Attachments: tutorial.osr_

In this challenge we were given a replay file of the game OSU.
![OSU game](/assets/img/UMDCTF_2022/RSI-1-OSU.gif)

If we analyze the given file with `hexdump` or a similar tool we can right away observe that the bytes that should represent the replay are not correct according to the [official table](https://osu.ppy.sh/wiki/en/Client/File_formats/Osr_%28file_format%29) shown below:
![OSR_FILE_DATA_TABLE](/assets/img/UMDCTF_2022/osr-file-osu.png)

Analyzing the file with `binwalk` we observe that it is an LZMA file so with the command shown below we obtain the extracted file.

```shell
binwalk -e tutorial.osr
```

Analyzing it with `strings` gives us the flag.

![RSI-1_Flag](/assets/img/UMDCTF_2022/RSI-1-Flag.png)

üèÅ __UMDCTF{wE1c0m3_t0_o5u!}__{:.spoiler}

## RSI 2

> _I got addicted to the game, and my friend left me another one of his cool replays._<br>
> _Attachments: big\_b.osr_

As in the previous writeup ([RSI 1](#rsi-1)) we have a .osr file that we can analyze with the same method. After getting the extracted file, we don't get the flag as before but we are given a set of coordinates. Looking at those we can see that some don't respect the osu costraint shown below:
![OSU-COORDINATES-COSTRAINT](/assets/img/UMDCTF_2022/RSI2-Coordinates-Costraint.png)

Finally with some scripting we can parse the coordinates, taking only the correct ones, and render the output image:
```python
import matplotlib.pyplot as plt

def validate_coord(coord):
    length = len(coord) == 4 and int(coord[0]) > 0
    if length:
        x = 0 <= float(coord[1]) <= 512
        y = 0 <= float(coord[2]) <= 384
        return x and y
    return False

with open("_big_b.osr.extracted/7F") as replay_raw:
    coords_raw = replay_raw.readline().split(',')

coords_raw = [tuple(x.split('|')) for x in coords_raw]
coords_raw = [t for t in coords_raw if validate_coord(t)]

coords = []
for t in coords_raw:
    coords.append((int(t[0]), float(t[1]), float(t[2]), int(t[3])))

x, y = [p[1] for p in coords], [-p[2] for p in coords]

plt.scatter(x, y)
plt.show()
```

The result is shown here:
![RS2-Flag](/assets/img/UMDCTF_2022/RSI2-flag.png)


üèÅ __UMDCTF{CL1CK_TO_THE_B3AT}__{:.spoiler}

---

# OsInt

## Justina 1

> _After Justin's adventure in Russia, his sister, Justina Zimmerman has scurried off somewhere and we need to find her. There must be a way to see what she has been up to. Justin might even be able to help us._

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Justina 2

> _Can you figure out which city Justina has been staying in? Hopefully we can find her soon!_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Justina 3

> _I think Justina is going to another place! I can't keep up with her. Help me find her._

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Justina 4

> _I've been chatting with Justina as she travels, and she is settling down with her french boyfriend. They are even having a kid! I want to send her a baby shower gift but I don't know what to get her... She told me there is some online registry for gifts but it's under her boyfriends name. Can you find the registry online?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## ketchup

> _I took a picture with this guy a few years ago but I forgot his name! Can you tell me who he is?_<br>
> _Attachments: ketchup.png_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Outdoors 1

> _My friend Jason Heyson recently got into live-streaming. He's been streaming a place in his hometown, but he won't give me the link! It must be related to the environment, the outdoors, or real life given my current context. Can you find his stream for me?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Outdoors 2

> _Thank you for finding the livestream. It looks like Jason must have moved because I do not recognize the the place he is streaming at all! Can you give me the address of the orangeish building on the live stream?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Unaccounted For Co-Worker

> _Help! My co-worker hasn't showed up to work for the past week and my boss wants me to find out where he went. I know that he took an American Airlines flight from the "Mile High City" to the city with the largest historic theatre district on February 24th. A couple days later, I heard he took a train northwest 8 stops from Union Station. Can you tell me the aircraft type and the final destination city?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

---

# Pwn

## Classic Act

> _Pwning your friends is a class act. So why not do it to some random server?_<br>
> _Attachments: classicact_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Legacy

> _Fred just won‚Äôt keep up with the times. Why don't you show him the error of his ways?_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## The Show Must Go On

> _We are in the business of entertainment, the show must go on! Hope we can find someone to replace our old act super fast..._<br>
> _Attachments: theshow_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

---

# Rev

## DragonPit

> _Fred is trying to learn how to deal with dragons. Can you help him out?_<br>
> _Attachments: dragonPit_

For this challenge we were given an ELF file, analyzing it with ghidra we can see that at first it asks us for an input and then compares it with a secret sentence: if the strings are equal the program prints the flag as shown in the image below.

![dragon_pit_ghidra](/assets/img/UMDCTF_2022/dragon_pit.png)

After having spent some time reconstructing the sentence with ghidra I decided to switch to gdb with wich we can right away analyze the cmp function and see in clear our secret sentence.
![dragon_pit_gdb](/assets/img/UMDCTF_2022/dragon_pit_gdb.png){: .image-full}

In the first image we can see that the program asks: "When should Fred jump into the dragon pit?", looking at the two sentences on the second image we can see that the first one makes more sense then the second.
In fact running the program with the input `wh3nTheDr4gsHPis1048` gives us the flag.

![dragon_pit_solution](/assets/img/UMDCTF_2022/dragon_pit_sol.png)

üèÅ __UMDCTF{BluSt0l3dr4g}__{:.spoiler}

## tiny

> _Scan for free crypto currency!_<br>
> _Attachments: tiny.png_

In this challenge we were given a .png file, it being a reverse engineering problem I decided to analyze it with cyberchef hoping to find something more useful, in fact using Parse QR code, From base64 and Extract Files modules a .xz file was obtained wich contained an ELF file.

Analyzing the file with ghidra we can observe two core functions, the first one encrypts the first part of the flag xoring each character with its position in the string, as we can see in the image below:

![first_function](/assets/img/UMDCTF_2022/tiny_first_function.png)

With ghidra we can take the bytes that the function is xoring and simulate the process to get the first part of the flag as we see in the image below.
![first_part_script](/assets/img/UMDCTF_2022/tiny_first_part_script.png)

The second one encrypts the second part of the flag in a different way, it shifts the byte and xors it, the tricky part here was "understanding" the right order of the two operations.
![second_function](/assets/img/UMDCTF_2022/tiny_second_function.png)

As before we can take the bytes with ghidra and write a tiny script in python to simulate the process as it is shown below:
![second_part_script](/assets/img/UMDCTF_2022/tiny_second_part_script.png)

üèÅ __UMDCTF{h3y_m0m_1m_0n_th3_r@d1o}__{:.spoiler}

---

# Web

## A Simple Calculator

> _Calc you later! :)_<br>
> _Attachments: A\_Simple\_Calculator.zip_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}

## Customer Support

> _Contact Devils customer supoprt and see what they have to offer._<br>
> _Attachments: Customer\_Support.zip_

// TODO: writeup

üèÅ __UMDCTF{...}__{:.spoiler}
